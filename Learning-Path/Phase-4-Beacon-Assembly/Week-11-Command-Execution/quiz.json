{
  "title": "Week 11: Command Execution Quiz",
  "description": "Test your understanding of command execution, output capture, and command dispatchers",
  "passingScore": 70,
  "questions": [
    {
      "id": 1,
      "question": "Which Windows API function is used to create an anonymous pipe for capturing command output?",
      "options": [
        "CreateNamedPipe()",
        "CreatePipe()",
        "CreateFile()",
        "PipeCreate()"
      ],
      "correctAnswer": 1,
      "explanation": "CreatePipe() creates an anonymous pipe with read and write handles, perfect for parent-child process communication."
    },
    {
      "id": 2,
      "question": "Which flag must be set in STARTUPINFO to redirect a process's stdout and stderr?",
      "options": [
        "STARTF_REDIRECT",
        "STARTF_USESTDHANDLES",
        "STARTF_USEPIPES",
        "STARTF_FORCEOUTPUT"
      ],
      "correctAnswer": 1,
      "explanation": "STARTF_USESTDHANDLES tells CreateProcess to use the handles specified in hStdInput, hStdOutput, and hStdError."
    },
    {
      "id": 3,
      "question": "Why should the read handle of a pipe NOT be inherited by the child process?",
      "options": [
        "It causes the pipe to remain open indefinitely",
        "It's a security risk",
        "Windows doesn't allow it",
        "It improves performance"
      ],
      "correctAnswer": 0,
      "explanation": "If the child inherits the read handle, the pipe remains open even after the child exits, preventing ReadFile from detecting end-of-pipe."
    },
    {
      "id": 4,
      "question": "Which Windows API is used to enumerate directory contents?",
      "options": [
        "EnumDirectory() / EnumNext()",
        "FindFirstFile() / FindNextFile()",
        "ListDirectory() / NextEntry()",
        "OpenDirectory() / ReadDirectory()"
      ],
      "correctAnswer": 1,
      "explanation": "FindFirstFile() starts enumeration and returns a handle. FindNextFile() iterates through remaining entries."
    },
    {
      "id": 5,
      "question": "What is the purpose of the CREATE_NO_WINDOW flag in CreateProcessA?",
      "options": [
        "Improves process performance",
        "Prevents console window from appearing",
        "Required for pipe redirection",
        "Enables silent error handling"
      ],
      "correctAnswer": 1,
      "explanation": "CREATE_NO_WINDOW prevents a console window from appearing, crucial for stealth in beacon implementations."
    },
    {
      "id": 6,
      "question": "In a command dispatcher, what is the primary purpose of the command table?",
      "options": [
        "Store command history",
        "Map command names to handler functions",
        "Cache command outputs",
        "Validate command syntax"
      ],
      "correctAnswer": 1,
      "explanation": "The command table maps command names to their corresponding handler functions, enabling efficient command routing."
    },
    {
      "id": 7,
      "question": "Why is it better to implement commands like 'pwd' and 'cd' using Windows API instead of spawning cmd.exe?",
      "options": [
        "Windows API is faster",
        "Better stealth - no cmd.exe process",
        "More features available",
        "Easier to implement"
      ],
      "correctAnswer": 1,
      "explanation": "Using Windows API (GetCurrentDirectory, SetCurrentDirectory) avoids spawning cmd.exe, reducing detection surface."
    },
    {
      "id": 8,
      "question": "What error code indicates the end of a pipe when using ReadFile()?",
      "options": [
        "ERROR_NO_MORE_DATA",
        "ERROR_BROKEN_PIPE",
        "ERROR_PIPE_CLOSED",
        "ERROR_END_OF_FILE"
      ],
      "correctAnswer": 1,
      "explanation": "ERROR_BROKEN_PIPE indicates the write end of the pipe has been closed, signaling no more data will arrive."
    },
    {
      "id": 9,
      "question": "When capturing command output, why should you implement a timeout with WaitForSingleObject?",
      "options": [
        "Required by Windows API",
        "Improves output quality",
        "Prevents beacon from hanging on long-running commands",
        "Reduces memory usage"
      ],
      "correctAnswer": 2,
      "explanation": "A timeout prevents the beacon from hanging indefinitely if a command runs too long or hangs."
    },
    {
      "id": 10,
      "question": "In the context of file listing, what does the FILE_ATTRIBUTE_DIRECTORY flag indicate?",
      "options": [
        "The file is a shortcut to a directory",
        "The file can contain other files",
        "The entry is a directory, not a file",
        "The file has directory permissions"
      ],
      "correctAnswer": 2,
      "explanation": "FILE_ATTRIBUTE_DIRECTORY in dwFileAttributes indicates the entry is a directory rather than a regular file."
    }
  ]
}
